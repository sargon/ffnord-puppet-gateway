# this file is generated by puppet

# bird6 community configuration

protocol static 'local_<%= @mesh_code %>' {
  table 'mesh';
  # reject route if announced from external
  route <%= @site_ipv6_prefix %>/<%= @site_ipv6_prefixlen %> via "br-<%= @mesh_code%>";
};

# template for local mesh connections
# extend local_mesh template
template bgp 'local_mesh_<%=@mesh_code%>' from local_mesh {
  source address <%=@mesh_ipv6_address%>;
  local as <%=@icvpn_as%>;
};

include "/etc/bird/bird6.conf.d/<%=mesh_code%>_neighbors.conf"
